<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DIBELS Practice Lab - Free Early Literacy Training</title>
    <meta name="description" content="Unlimited, open-access practice and training for fluency-based early literacy. Practice DIBELS 8 subtests for grades K-8.">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-32x32.png">
    <link rel="icon" type="image/png" sizes="48x48" href="/icons/icon-48x48.png">
    
    <!-- Social Media Meta Tags -->
    <meta property="og:title" content="DIBELS Practice Lab - Free Early Literacy Training">
    <meta property="og:description" content="Unlimited, open-access practice and training for fluency-based early literacy. Practice DIBELS 8 subtests for grades K-8.">
    <meta property="og:image" content="/social-image.png">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:url" content="https://dibels.lab">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="DIBELS Practice Lab">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="DIBELS Practice Lab - Free Early Literacy Training">
    <meta name="twitter:description" content="Unlimited, open-access practice and training for fluency-based early literacy. Practice DIBELS 8 subtests for grades K-8.">
    <meta name="twitter:image" content="/social-image.png">
    
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#6366f1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="DIBELS Lab">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    
    <!-- Additional PWA meta tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="DIBELS Lab">
    <meta name="msapplication-TileColor" content="#6366f1">
    <meta name="msapplication-tap-highlight" content="no">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
                <span class="icon" id="theme-icon">ðŸŒ™</span>
                <span id="theme-text">Dark</span>
            </button>
            <div class="container">
                <h1 class="logo">ðŸ“š DIBELS Practice Lab</h1>
                <p class="tagline">Unlimited, open-access practice and training for fluency-based early literacy</p>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <div class="container">
                <!-- Welcome Section -->
                <section class="welcome-section" id="welcome-section">
                    <h2>Welcome to DIBELS Practice Lab</h2>
                    <p>Practice DIBELS 8 subtests with students in grades K-8. Choose your grade level and subtest to begin.</p>
                    
                    <!-- Grade Selection -->
                    <div class="grade-selection">
                        <h3>Select Grade Level</h3>
                        <div class="grade-buttons">
                            <button class="grade-btn" data-grade="K">Kindergarten</button>
                            <button class="grade-btn" data-grade="1">Grade 1</button>
                            <button class="grade-btn" data-grade="2">Grade 2</button>
                            <button class="grade-btn" data-grade="3">Grade 3</button>
                            <button class="grade-btn" data-grade="4">Grade 4</button>
                            <button class="grade-btn" data-grade="5">Grade 5</button>
                            <button class="grade-btn" data-grade="6">Grade 6</button>
                            <button class="grade-btn" data-grade="7">Grade 7</button>
                            <button class="grade-btn" data-grade="8">Grade 8</button>
                        </div>
                    </div>

                    <!-- Subtest Selection -->
                    <div class="subtest-selection hidden" id="subtest-selection">
                        <h3>Select Subtest</h3>
                        <div class="subtest-buttons" id="subtest-buttons">
                            <!-- Dynamically populated based on grade -->
                        </div>
                    </div>

                    <!-- Practice Options -->
                    <div class="practice-options hidden" id="practice-options">
                        <h3>Practice Options</h3>
                        <div class="options-grid">
                            <label class="option-item">
                                <input type="checkbox" id="timed-mode" checked>
                                <span class="checkmark"></span>
                                <span class="option-text">Timed Practice (60 seconds)</span>
                            </label>
                            <label class="option-item">
                                <input type="checkbox" id="show-timer">
                                <span class="checkmark"></span>
                                <span class="option-text">Show Timer</span>
                            </label>
                            <label class="option-item">
                                <input type="checkbox" id="reveal-answers">
                                <span class="checkmark"></span>
                                <span class="option-text">Reveal Answers</span>
                            </label>
                            <label class="option-item">
                                <input type="checkbox" id="audio-modeling">
                                <span class="checkmark"></span>
                                <span class="option-text">Audio Modeling</span>
                            </label>
                        </div>
                        <button class="start-practice-btn" id="start-practice">Start Practice</button>
                    </div>
                </section>

                <!-- Practice Interface -->
                <section class="practice-section hidden" id="practice-section">
                    <div class="practice-header">
                        <div class="practice-info">
                            <h2 id="practice-title">Practice Session</h2>
                            <p id="practice-subtitle">Grade K - Letter Naming Fluency</p>
                        </div>
                        <div class="timer-container">
                            <div class="timer" id="timer" role="timer" aria-live="polite" aria-atomic="true" aria-label="Time remaining">60</div>
                            <div class="timer-label">seconds</div>
                        </div>
                    </div>

                    <div class="practice-content" id="practice-content" role="main" aria-label="Practice exercise content">
                        <!-- Content will be dynamically loaded -->
                    </div>

                    <div class="practice-controls" role="group" aria-label="Practice controls">
                        <button class="control-btn" id="pause-btn" aria-label="Pause or resume timer">Pause</button>
                        <button class="control-btn" id="reset-btn" aria-label="Reset and restart practice">Reset</button>
                        <button class="control-btn" id="new-set-btn" aria-label="Generate new practice set">New Set</button>
                        <button class="control-btn" id="back-to-menu" aria-label="Return to main menu">Back to Menu</button>
                    </div>

                    <div class="scoring-panel hidden" id="scoring-panel" role="region" aria-label="Scoring panel">
                        <h3>Scoring</h3>
                        <div class="score-inputs">
                            <label for="correct-responses">
                                Correct Responses: 
                                <input type="number" id="correct-responses" min="0" max="1000" value="0" 
                                       aria-label="Number of correct responses" 
                                       aria-describedby="score-result correct-responses-error"
                                       aria-invalid="false">
                                <span class="input-error" id="correct-responses-error" role="alert" aria-live="polite"></span>
                            </label>
                            <label for="errors">
                                Errors: 
                                <input type="number" id="errors" min="0" max="1000" value="0" 
                                       aria-label="Number of errors" 
                                       aria-describedby="score-result errors-error"
                                       aria-invalid="false">
                                <span class="input-error" id="errors-error" role="alert" aria-live="polite"></span>
                            </label>
                            <button class="control-btn" id="calculate-score" aria-label="Calculate final score">Calculate Score</button>
                        </div>
                        
                        <!-- Real-time accuracy indicator -->
                        <div class="accuracy-indicator hidden" id="accuracy-indicator" role="status" aria-live="polite">
                            <div class="accuracy-bar">
                                <div class="accuracy-fill" id="accuracy-fill"></div>
                            </div>
                            <span class="accuracy-text" id="accuracy-text">Enter scores to see accuracy</span>
                        </div>
                        
                        <!-- Accuracy warning container -->
                        <div id="accuracy-warning" class="hidden" role="alert" aria-live="assertive"></div>
                        
                        <div class="score-result" id="score-result" role="status" aria-live="polite" aria-atomic="true"></div>
                    </div>
                </section>

                <!-- Educator Mode -->
                <section class="educator-section hidden" id="educator-section">
                    <h2>Educator Training Mode</h2>
                    <div class="training-modules">
                        <div class="module-card">
                            <h3>Administration Guide</h3>
                            <p>Learn how to properly administer each DIBELS subtest</p>
                            <button class="module-btn" data-module="administration">View Guide</button>
                        </div>
                        <div class="module-card">
                            <h3>Scoring Practice</h3>
                            <p>Practice scoring with sample student responses</p>
                            <button class="module-btn" data-module="scoring">Start Practice</button>
                        </div>
                        <div class="module-card">
                            <h3>Error Analysis</h3>
                            <p>Learn to identify and analyze common student errors</p>
                            <button class="module-btn" data-module="errors">View Examples</button>
                        </div>
                    </div>
                </section>

                <!-- Settings Panel -->
                <section class="settings-section hidden" id="settings-section">
                    <h2>Settings</h2>
                    <div class="settings-grid">
                        <div class="settings-card">
                            <h3>Accessibility</h3>
                            <div class="setting-item">
                                <label for="font-size-select">Font Size:</label>
                                <select id="font-size-select">
                                    <option value="0.875rem">Small</option>
                                    <option value="1rem" selected>Normal</option>
                                    <option value="1.125rem">Large</option>
                                    <option value="1.25rem">Extra Large</option>
                                </select>
                            </div>
                            <div class="setting-item">
                                <label for="high-contrast-toggle">High Contrast Mode:</label>
                                <input type="checkbox" id="high-contrast-toggle">
                            </div>
                            <div class="setting-item">
                                <label for="reduced-motion-toggle">Reduce Motion:</label>
                                <input type="checkbox" id="reduced-motion-toggle">
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3>Practice Settings</h3>
                            <div class="setting-item">
                                <label for="default-timer">Default Timer (seconds):</label>
                                <input type="number" id="default-timer" min="10" max="300" value="60">
                            </div>
                            <div class="setting-item">
                                <label for="auto-save-toggle">Auto-save Progress:</label>
                                <input type="checkbox" id="auto-save-toggle" checked>
                            </div>
                            <div class="setting-item">
                                <label for="sound-effects-toggle">Sound Effects:</label>
                                <input type="checkbox" id="sound-effects-toggle" checked>
                            </div>
                        </div>
                        
                        <div class="settings-card">
                            <h3>Data Management</h3>
                            <div class="setting-item">
                                <button class="control-btn" id="export-data-btn">Export Data</button>
                            </div>
                            <div class="setting-item">
                                <button class="control-btn" id="import-data-btn">Import Data</button>
                                <input type="file" id="import-file" accept=".json" style="display: none;">
                            </div>
                            <div class="setting-item">
                                <button class="control-btn" id="clear-data-btn">Clear All Data</button>
                            </div>
                        </div>
                    </div>
                    <button class="control-btn" id="close-settings-btn">Close Settings</button>
                </section>

                <!-- Progress Panel -->
                <section class="progress-section hidden" id="progress-section">
                    <h2>Practice Progress</h2>
                    <div class="progress-stats">
                        <div class="stat-card">
                            <h3>Overall Statistics</h3>
                            <div id="overall-stats">
                                <p>Total Sessions: <span id="total-sessions">0</span></p>
                                <p>Total Time: <span id="total-time">0 minutes</span></p>
                                <p>Average Score: <span id="average-score">0</span></p>
                                <p>Average Accuracy: <span id="average-accuracy">0%</span></p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Recent Sessions</h3>
                            <div id="recent-sessions">
                                <p>No sessions yet. Start practicing to see your progress!</p>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Grade Performance</h3>
                            <div id="grade-stats">
                                <p>Select a grade to see detailed statistics.</p>
                            </div>
                        </div>
                    </div>
                    <button class="control-btn" id="close-progress-btn">Close Progress</button>
                </section>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <!-- Important Disclaimers for Educators -->
                <div class="disclaimer-section">
                    <h3>Important Information for Educators</h3>
                    <div class="disclaimer-content">
                        <div class="disclaimer-item">
                            <strong>Benchmark Scores:</strong> Based on general DIBELS 8 guidance. Verify against official materials for your specific assessment period.
                        </div>
                        <div class="disclaimer-item">
                            <strong>Practice Tool:</strong> This is a practice tool aligned with DIBELS 8 standards, not official DIBELS materials.
                        </div>
                        <div class="disclaimer-item">
                            <strong>Regular Updates:</strong> Content should be reviewed against official DIBELS updates for accuracy.
                        </div>
                    </div>
                </div>
                
                <p>&copy; 2025 DIBELS Practice Lab. Open source educational resource.</p>
                <div class="footer-links">
                    <button class="footer-link" id="educator-mode-btn">Educator Mode</button>
                    <button class="footer-link" id="settings-btn">Settings</button>
                    <button class="footer-link" id="progress-btn">Progress</button>
                    <button class="footer-link" id="accessibility-btn">Accessibility</button>
                    <button class="footer-link" id="about-btn">About</button>
                </div>
            </div>
        </footer>
    </div>

    <!-- Audio Elements -->
    <audio id="audio-player" preload="none"></audio>
    
    <!-- Screen Reader Announcements -->
    <div id="sr-announcements" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

    <!-- Scripts -->
    <script src="data/content.js"></script>
    <script src="js/theme.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/scoring.js"></script>
    <script src="js/subtests.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/print.js"></script>
    <script src="js/accessibility.js"></script>
    <script src="js/keyboard.js"></script>
    <script src="js/progress.js"></script>
    <script src="js/app.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        // Register service worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then((registration) => {
                        console.log('Service Worker registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    // New content is available, show update notification
                                    if (confirm('New version available! Reload to update?')) {
                                        window.location.reload();
                                    }
                                }
                            });
                        });
                    })
                    .catch((error) => {
                        console.log('Service Worker registration failed:', error);
                    });
            });
        }
        
        // Handle PWA install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button or notification
            const installButton = document.createElement('button');
            installButton.textContent = 'Install App';
            installButton.className = 'install-btn';
            installButton.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: var(--primary-color);
                color: white;
                border: none;
                padding: 12px 24px;
                border-radius: 8px;
                font-weight: 600;
                cursor: pointer;
                z-index: 1000;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            `;
            
            installButton.addEventListener('click', () => {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    }
                    deferredPrompt = null;
                    installButton.remove();
                });
            });
            
            document.body.appendChild(installButton);
        });
        
        // Handle app installed
        window.addEventListener('appinstalled', () => {
            console.log('PWA was installed');
        });
    </script>
</body>
</html>
